<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#1a1a2e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>No_Gas_Labs™ Celebrity Deathmatch</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Courier New', monospace;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      color: #e94560;
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 600px;
      margin: 0 auto;
    }

    h1 {
      text-align: center;
      font-size: 2rem;
      margin-bottom: 30px;
      text-shadow: 0 0 10px #e94560;
      word-wrap: break-word;
    }

    .controls {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-top: 30px;
    }

    button {
      background: #0f3460;
      color: #e94560;
      border: 2px solid #e94560;
      padding: 22px 30px;
      font-size: 1.2rem;
      font-family: 'Courier New', monospace;
      cursor: pointer;
      min-height: 44px;
      min-width: 44px;
      transition: all 0.3s ease;
      text-transform: uppercase;
      font-weight: bold;
    }

    button:hover {
      background: #e94560;
      color: #0f3460;
      box-shadow: 0 0 20px #e94560;
    }

    button:active {
      transform: scale(0.95);
    }

    #status {
      text-align: center;
      margin-top: 30px;
      padding: 20px;
      background: rgba(15, 52, 96, 0.5);
      border: 2px solid #e94560;
      min-height: 100px;
    }

    .stats {
      text-align: center;
      margin-top: 20px;
      font-size: 0.9rem;
      color: #aaa;
    }

    @media (max-width: 480px) {
      h1 {
        font-size: 1.5rem;
      }
      
      button {
        font-size: 1rem;
        padding: 18px 24px;
      }
    }

    .fighters-grid {
      display: none;
      margin-top: 30px;
    }

    .fighters-grid h2 {
      text-align: center;
      margin-bottom: 20px;
      font-size: 1.5rem;
    }

    #fightersList {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 15px;
    }

    .fighter-card {
      background: rgba(15, 52, 96, 0.8);
      border: 2px solid #e94560;
      padding: 15px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      min-height: 200px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .fighter-card:hover {
      background: #e94560;
      color: #0f3460;
      transform: scale(1.05);
    }

    .fighter-card.selected {
      background: #e94560;
      color: #0f3460;
      box-shadow: 0 0 20px #e94560;
    }

    .fighter-name {
      font-size: 1.1rem;
      font-weight: bold;
      margin-bottom: 10px;
      word-wrap: break-word;
    }

    .fighter-stats {
      font-size: 0.8rem;
      text-align: left;
    }

    .stat-row {
      display: flex;
      justify-content: space-between;
      margin: 3px 0;
    }

    .fighter-xp {
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid #e94560;
      font-size: 0.75rem;
    }

    .back-btn {
      background: #0f3460;
      color: #e94560;
      border: 2px solid #e94560;
      padding: 15px 25px;
      margin-top: 20px;
      width: 100%;
      min-height: 44px;
    }

    @media print {
      body {
        background: white;
        color: black;
      }
      
      button {
        display: none;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>No_Gas_Labs™<br>Celebrity Deathmatch</h1>
    
    <div id="status">
      <p>Ready to rumble!</p>
      <p>Iteration: 1 - Infrastructure Complete</p>
    </div>
    
    <div id="fightersGrid" class="fighters-grid" style="display: none;">
      <h2>Select Your Fighter</h2>
      <div id="fightersList"></div>
    </div>

    <div class="controls">
      <button id="exportBtn" onclick="exportData()">Export Data</button>
      <button id="importBtn" onclick="importData()">Import Data</button>
      <button id="resetBtn" onclick="resetData()">Reset Data</button>
      <button id="fightersBtn" onclick="showFighters()">Fighters</button>
    </div>
    
    <div class="stats">
      <p>Version: 1.0.0-iter-2</p>
      <p>Offline-capable | No dependencies</p>
    </div>
  </div>

  <script>
    // No_Gas_Labs™ Celebrity Deathmatch - Core Infrastructure
    // Ralph Loop Iteration 2
    // Zero external dependencies - localStorage powered

    const STORAGE_KEY = 'ngl_deathmatch_data';
    const VERSION = '1.0.0-iter-2';

    // Fighter Database
    const FIGHTERS = [
      {
        id: 1,
        name: 'The Rock',
        type: 'Brawler',
        hp: 150,
        attack: 25,
        defense: 20,
        speed: 15,
        special: 'Rock Bottom',
        xp: 0,
        level: 1,
        wins: 0,
        losses: 0
      },
      {
        id: 2,
        name: 'Elon Musk',
        type: 'Tech',
        hp: 100,
        attack: 35,
        defense: 10,
        speed: 25,
        special: 'To The Moon',
        xp: 0,
        level: 1,
        wins: 0,
        losses: 0
      },
      {
        id: 3,
        name: 'Taylor Swift',
        type: 'Pop Star',
        hp: 120,
        attack: 30,
        defense: 15,
        speed: 20,
        special: 'Shake It Off',
        xp: 0,
        level: 1,
        wins: 0,
        losses: 0
      },
      {
        id: 4,
        name: 'Keanu Reeves',
        type: 'Action Hero',
        hp: 140,
        attack: 28,
        defense: 22,
        speed: 18,
        special: 'Matrix Dodge',
        xp: 0,
        level: 1,
        wins: 0,
        losses: 0
      },
      {
        id: 5,
        name: 'Gordon Ramsay',
        type: 'Chef',
        hp: 110,
        attack: 32,
        defense: 12,
        speed: 22,
        special: 'RAGE QUIT',
        xp: 0,
        level: 1,
        wins: 0,
        losses: 0
      },
      {
        id: 6,
        name: 'Dwayne Johnson',
        type: 'Brawler',
        hp: 160,
        attack: 22,
        defense: 25,
        speed: 12,
        special: 'People\'s Elbow',
        xp: 0,
        level: 1,
        wins: 0,
        losses: 0
      }
    ];

    let selectedFighter = null;

    // Initialize on load
    window.onload = function() {
      console.log('No_Gas_Labs™ Deathmatch initialized');
      console.log('Version:', VERSION);
      console.log('Iteration: 2');
      console.log('Fighters loaded:', FIGHTERS.length);
      loadData();
    };

    // localStorage functions
    function saveData(data) {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
        console.log('Data saved successfully');
        return true;
      } catch (e) {
        console.error('Save failed:', e);
        alert('Save failed: ' + e.message);
        return false;
      }
    }

    function loadData() {
      try {
        const stored = localStorage.getItem(STORAGE_KEY);
        if (stored) {
          const data = JSON.parse(stored);
          console.log('Data loaded:', data);
          
          // Restore selected fighter
          if (data.selectedFighterId) {
            selectedFighter = FIGHTERS.find(f => f.id === data.selectedFighterId);
          }
          
          return data;
        } else {
          console.log('No saved data found');
          return null;
        }
      } catch (e) {
        console.error('Load failed:', e);
        return null;
      }
    }

    // Export function
    function exportData() {
      try {
        const data = loadData() || { version: VERSION, timestamp: Date.now() };
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `deathmatch-${Date.now()}.json`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        updateStatus('Data exported successfully!');
        console.log('Export successful');
      } catch (e) {
        console.error('Export failed:', e);
        alert('Export failed: ' + e.message);
      }
    }

    // Import function
    function importData() {
      try {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = '.json';
        input.onchange = function(e) {
          const file = e.target.files[0];
          const reader = new FileReader();
          reader.onload = function(e) {
            try {
              const data = JSON.parse(e.target.result);
              if (saveData(data)) {
                updateStatus('Data imported successfully!');
                console.log('Import successful:', data);
              }
            } catch (err) {
              alert('Invalid JSON file: ' + err.message);
            }
          };
          reader.readAsText(file);
        };
        input.click();
      } catch (e) {
        console.error('Import failed:', e);
        alert('Import failed: ' + e.message);
      }
    }

    // Reset function
    function resetData() {
      if (confirm('Are you sure you want to reset all data? This cannot be undone!')) {
        try {
          localStorage.removeItem(STORAGE_KEY);
          updateStatus('Data reset successfully!');
          console.log('Reset successful');
        } catch (e) {
          console.error('Reset failed:', e);
          alert('Reset failed: ' + e.message);
        }
      }
    }

    // Update status display
    function updateStatus(message) {
      const statusDiv = document.getElementById('status');
      statusDiv.innerHTML = '<p>' + message + '</p>';
    }

    // Show fighters grid
    function showFighters() {
      const grid = document.getElementById('fightersGrid');
      const list = document.getElementById('fightersList');
      
      if (grid.style.display === 'none' || grid.style.display === '') {
        grid.style.display = 'block';
        renderFighters();
      } else {
        grid.style.display = 'none';
      }
    }

    // Render fighters list
    function renderFighters() {
      const list = document.getElementById('fightersList');
      const savedData = loadData();
      
      list.innerHTML = FIGHTERS.map(fighter => {
        const savedFighter = savedData?.fighters?.find(f => f.id === fighter.id);
        const currentFighter = savedFighter || fighter;
        const isSelected = selectedFighter && selectedFighter.id === currentFighter.id;
        
        return `
          <div class="fighter-card ${isSelected ? 'selected' : ''}" onclick="selectFighter(${currentFighter.id})">
            <div>
              <div class="fighter-name">${currentFighter.name}</div>
              <div class="fighter-stats">
                <div class="stat-row"><span>HP:</span><span>${currentFighter.hp}</span></div>
                <div class="stat-row"><span>ATK:</span><span>${currentFighter.attack}</span></div>
                <div class="stat-row"><span>DEF:</span><span>${currentFighter.defense}</span></div>
                <div class="stat-row"><span>SPD:</span><span>${currentFighter.speed}</span></div>
              </div>
            </div>
            <div class="fighter-xp">
              <div>Lvl: ${currentFighter.level}</div>
              <div>XP: ${currentFighter.xp}</div>
              <div>W/L: ${currentFighter.wins}/${currentFighter.losses}</div>
            </div>
          </div>
        `;
      }).join('') + `
        <button class="back-btn" onclick="hideFighters()">Back</button>
      `;
    }

    // Hide fighters grid
    function hideFighters() {
      const grid = document.getElementById('fightersGrid');
      grid.style.display = 'none';
    }

    // Select fighter
    function selectFighter(id) {
      const fighter = FIGHTERS.find(f => f.id === id);
      if (fighter) {
        selectedFighter = fighter;
        renderFighters();
        updateStatus(`Selected: ${fighter.name}`);
        console.log('Fighter selected:', fighter.name);
        
        // Save selection
        const data = loadData() || {};
        data.selectedFighterId = id;
        saveData(data);
      }
    }

    // Service Worker registration for PWA (will be implemented later)
    if ('serviceWorker' in navigator) {
      console.log('Service Worker API available');
      // navigator.serviceWorker.register('/sw.js').catch(console.error);
    }

    // Prevent zoom on double-tap (mobile)
    document.addEventListener('dblclick', function(event) {
      event.preventDefault();
    }, { passive: false });

    // Prevent pull-to-refresh on mobile
    document.body.addEventListener('touchmove', function(e) {
      if (e.touches.length > 1) {
        e.preventDefault();
      }
    }, { passive: false });
  </script>
</body>
</html>